!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){c.FLACDemuxer=a("./src/demuxer"),c.FLACDecoder=a("./src/decoder"),a("./src/ogg")},{"./src/decoder":2,"./src/demuxer":3,"./src/ogg":4}],2:[function(a,b,c){var d=window.AV,e=d.Decoder.extend(function(){function a(a,b,c){var d=b*c,e=0>d;e&&(d=-d);var f=d%l|0,g=d/l|0;e&&(f=~f+1,g=~g);var h=a[1]>>>16,i=65535&a[1],j=a[0]>>>16,k=65535&a[0],m=g>>>16,n=65535&g,o=f>>>16,p=65535&f,q=0,r=0,s=0,t=0;t+=k+p,s+=t>>>16,t&=65535,s+=j+o,r+=s>>>16,s&=65535,r+=i+n,q+=r>>>16,r&=65535,q+=h+m,q&=65535,a[0]=s<<16|t,a[1]=q<<16|r}function b(a){for(var b=0,c=0;;){if(c=a>>>24)break;if(b+=8,c=a>>>16,255&c)break;if(b+=8,c=a>>>8,255&c)break;if(b+=8,c=a,255&c)break;return b+=8}return 240&c?c>>>=4:b+=4,8&c?b:4&c?b+1:2&c?b+2:1&c?b+3:b+4}d.Decoder.register("flac",this),this.prototype.setCookie=function(a){this.cookie=a,this.decoded=[];for(var b=0;b<this.format.channelsPerFrame;b++)this.decoded[b]=new Int32Array(a.maxBlockSize);this.lpc_total=new Int32Array(2)};const c=new Int16Array([0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768]),e=new Int32Array([0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0]),f=new Int8Array([0,8,12,0,16,20,24,0]),g=8,h=0,i=8,j=9,k=10;this.prototype.readChunk=function(){var a=this.bitstream;if(a.available(32)){if(32764!==(32767&a.read(15)))throw new Error("Invalid sync code");var b=(a.read(1),a.read(4)),d=a.read(4),l=a.read(4),m=a.read(3);a.advance(1),this.chMode=l;var n;if(g>l)n=l+1,this.chMode=h;else{if(!(k>=l))throw new Error("Invalid channel mode");n=2}if(n!==this.format.channelsPerFrame)throw new Error("Switching channel layout mid-stream not supported.");if(3===m||7===m)throw new Error("Invalid sample size code");if(this.bps=f[m],this.bps!==this.format.bitsPerChannel)throw new Error("Switching bits per sample mid-stream not supported.");for(var o=0;1===a.read(1);)o++;for(var p=a.read(7-o);o>1;o--)a.advance(2),p=p<<6|a.read(6);if(0===b)throw new Error("Reserved blocksize code");6===b?this.blockSize=a.read(8)+1:7===b?this.blockSize=a.read(16)+1:this.blockSize=c[b];var q;if(12>d)q=e[d];else if(12===d)q=1e3*a.read(8);else if(13===d)q=a.read(16);else{if(14!==d)throw new Error("Invalid sample rate code");q=10*a.read(16)}a.advance(8);for(var r=0;n>r;r++)this.decodeSubframe(r);a.align(),a.advance(16);var s=this.bps>16,t=new ArrayBuffer(this.blockSize*n*(s?4:2)),u=s?new Int32Array(t):new Int16Array(t),v=this.blockSize,w=this.decoded,x=0;switch(this.chMode){case h:for(var y=0;v>y;y++)for(var r=0;n>r;r++)u[x++]=w[r][y];break;case i:for(var r=0;v>r;r++){var z=w[0][r],A=w[1][r];u[x++]=z,u[x++]=z-A}break;case j:for(var r=0;v>r;r++){var z=w[0][r],A=w[1][r];u[x++]=z+A,u[x++]=A}break;case k:for(var r=0;v>r;r++){var z=w[0][r],A=w[1][r];z-=A>>1,u[x++]=z+A,u[x++]=z}}return u}},this.prototype.decodeSubframe=function(a){var b=0,c=this.bitstream,d=this.blockSize,e=this.decoded;if(this.curr_bps=this.bps,0===a?this.chMode===j&&this.curr_bps++:(this.chMode===i||this.chMode===k)&&this.curr_bps++,c.read(1))throw new Error("Invalid subframe padding");var f=c.read(6);if(c.read(1)){for(b=1;!c.read(1);)b++;this.curr_bps-=b}if(this.curr_bps>32)throw new Error("decorrelated bit depth > 32 ("+this.curr_bps+")");if(0===f)for(var g=c.read(this.curr_bps,!0),h=0;d>h;h++)e[a][h]=g;else if(1===f)for(var l=this.curr_bps,h=0;d>h;h++)e[a][h]=c.read(l,!0);else if(f>=8&&12>=f)this.decode_subframe_fixed(a,-9&f);else{if(!(f>=32))throw new Error("Invalid coding type");this.decode_subframe_lpc(a,(-33&f)+1)}if(b)for(var h=0;d>h;h++)e[a][h]<<=b},this.prototype.decode_subframe_fixed=function(a,b){for(var c=this.decoded[a],d=this.bitstream,e=this.curr_bps,f=0;b>f;f++)c[f]=d.read(e,!0);this.decode_residuals(a,b);var g=0,h=0,i=0,j=0;switch(b>0&&(g=c[b-1]),b>1&&(h=g-c[b-2]),b>2&&(i=h-c[b-2]+c[b-3]),b>3&&(j=i-c[b-2]+2*c[b-3]-c[b-4]),b){case 0:break;case 1:case 2:case 3:case 4:for(var k=new Int32Array([g,h,i,j]),l=this.blockSize,f=b;l>f;f++){k[b-1]+=c[f];for(var m=b-2;m>=0;m--)k[m]+=k[m+1];c[f]=k[0]}break;default:throw new Error("Invalid Predictor Order "+b)}},this.prototype.decode_subframe_lpc=function(b,c){for(var d=this.bitstream,e=this.decoded[b],f=this.curr_bps,g=this.blockSize,h=0;c>h;h++)e[h]=d.read(f,!0);var i=d.read(4)+1;if(16===i)throw new Error("Invalid coefficient precision");var j=d.read(5,!0);if(0>j)throw new Error("Negative qlevel, maybe buggy stream");for(var k=new Int32Array(32),h=0;c>h;h++)k[h]=d.read(i,!0);if(this.decode_residuals(b,c),this.bps<=16){for(var h=c;g-1>h;h+=2){for(var l=e[h-c],m=0,n=0,o=0,p=c-1;p>0;p--)o=k[p],m+=o*l,l=e[h-p],n+=o*l;o=k[0],m+=o*l,l=e[h]+=m>>j,n+=o*l,e[h+1]+=n>>j}if(g>h){for(var q=0,p=0;c>p;p++)q+=k[p]*e[h-p-1];e[h]+=q>>j}}else for(var r=this.lpc_total,h=c;g>h;h++){for(r[0]=0,r[1]=0,p=0;c>p;p++)a(r,k[p],e[h-p-1]);e[h]+=r[0]>>>j|r[1]<<32-j}};const l=Math.pow(2,32),m=32767;this.prototype.decode_residuals=function(a,b){var c=this.bitstream,d=c.read(2);if(d>1)throw new Error("Illegal residual coding method "+d);var e=c.read(4),f=this.blockSize>>>e;if(b>f)throw new Error("Invalid predictor order "+b+" > "+f);for(var g=this.decoded[a],h=b,i=b,j=0;1<<e>j;j++){var k=c.read(0===d?4:5);if(k===(0===d?15:31))for(k=c.read(5);f>i;i++)g[h++]=c.read(k,!0);else for(;f>i;i++)g[h++]=this.golomb(k,m,0);i=0}};this.prototype.golomb=function(a,c,d){var e=this.bitstream,f=e.bitPosition,g=e.peek(32-f)<<f,h=0,i=31-b(1|g);if(i-a>=7&&c>32-i)g>>>=i-a,g+=30-i<<a,e.advance(32+a-i),h=g;else{for(var j=0;0===e.read(1);j++)g=e.peek(32-f)<<f;c-1>j?(g=a?e.read(a):0,h=g+(j<<a)):j===c-1?(g=e.read(d),h=g+1):h=-1}return h>>1^-(1&h)}});b.exports=e},{}],3:[function(a,b,c){var d=window.AV,e=d.Demuxer.extend(function(){d.Demuxer.register(this),this.probe=function(a){return"fLaC"===a.peekString(0,4)};const a=0,b=3,c=4,e=6,f=34;this.prototype.readChunk=function(){var g=this.stream;if(!this.readHeader&&g.available(4)){if("fLaC"!==g.readString(4))return this.emit("error","Invalid FLAC file.");this.readHeader=!0}for(;g.available(1)&&!this.last;){if(!this.readBlockHeaders){var h=g.readUInt8();this.last=128===(128&h),this.type=127&h,this.size=g.readUInt24()}if(!this.foundStreamInfo&&this.type!==a)return this.emit("error","STREAMINFO must be the first block");if(!g.available(this.size))return;switch(this.type){case a:if(this.foundStreamInfo)return this.emit("error","STREAMINFO can only occur once.");if(this.size!==f)return this.emit("error","STREAMINFO size is wrong.");this.foundStreamInfo=!0;var i=new d.Bitstream(g),j={minBlockSize:i.read(16),maxBlockSize:i.read(16),minFrameSize:i.read(24),maxFrameSize:i.read(24)};this.format={formatID:"flac",sampleRate:i.read(20),channelsPerFrame:i.read(3)+1,bitsPerChannel:i.read(5)+1},this.emit("format",this.format),this.emit("cookie",j);var k=i.read(36);this.emit("duration",k/this.format.sampleRate*1e3|0),g.advance(16),this.readBlockHeaders=!1;break;case b:for(var l=0;l<this.size/18;l++)if(4294967295==g.peekUInt32(0)&&4294967295==g.peekUInt32(1))g.advance(18);else{g.readUInt32()>0&&this.emit("error","Seek points with sample number >UInt32 not supported");var m=g.readUInt32();g.readUInt32()>0&&this.emit("error","Seek points with stream offset >UInt32 not supported");var n=g.readUInt32();g.advance(2),this.addSeekPoint(n,m)}break;case c:this.metadata||(this.metadata={});var o=g.readUInt32(!0);this.metadata.vendor=g.readString(o);for(var p=g.readUInt32(!0),q=0;p>q;q++){o=g.readUInt32(!0);var r=g.readString(o,"utf8"),s=r.indexOf("=");this.metadata[r.slice(0,s).toLowerCase()]=r.slice(s+1)}break;case e:var t=g.readUInt32();if(3!==t)g.advance(this.size-4);else{var u=g.readUInt32(),v=(g.readString(u),g.readUInt32()),p=(g.readString(v),g.readUInt32(),g.readUInt32(),g.readUInt32(),g.readUInt32(),g.readUInt32()),w=g.readBuffer(p);this.metadata||(this.metadata={}),this.metadata.coverArt=w}break;default:g.advance(this.size),this.readBlockHeaders=!1}this.last&&this.metadata&&this.emit("metadata",this.metadata)}for(;g.available(1)&&this.last;){var x=g.readSingleBuffer(g.remainingBytes());this.emit("data",x)}}});b.exports=e},{}],4:[function(a,b,c){var d=window.AV;try{var e=window.AV.OggDemuxer}catch(f){}e&&e.plugins.push({magic:"FLAC",init:function(){this.list=new d.BufferList,this.stream=new d.Stream(this.list)},readHeaders:function(a){var b=this.stream;if(this.list.append(new d.Buffer(a)),b.advance(5),1!=b.readUInt8())throw new Error("Unsupported FLAC version");if(b.advance(3),"fLaC"!=b.peekString(0,4))throw new Error("Not flac");if(this.flac=d.Demuxer.find(b.peekSingleBuffer(0,b.remainingBytes())),!this.flac)throw new Error("Flac demuxer not found");return this.flac.prototype.readChunk.call(this),!0},readPacket:function(a){this.list.append(new d.Buffer(a)),this.flac.prototype.readChunk.call(this)}})},{}]},{},[1]);